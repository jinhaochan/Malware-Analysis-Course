# Malware-Analysis-Course
Stuff from udemy

## Structure of an Office file


### 1. OLE Compound File

OLE (Object Linking and Embedding) is the older representation of office objects (`.doc`, `.ppt`, `.xls`)

Magic number `D0 CF 11 E0 A1 B1 1A E1`

OLE is a collection of Storages and Stream. Storages stores other storages more stream, and the leaf of any OLE tree is always a stream

![image](https://user-images.githubusercontent.com/7328587/121039925-155fc180-c7e4-11eb-9800-e3f8dd7cafb3.png)

The text data is stored in `WordDocument`

The macros are stored in `Marcos`

### 2. OOXML

OOXML (Office Open XML) is the newer representation of office objects (`.docx`, `.pptx`, `.xlsx`)

It is simply a zip file, and you can open it by replacing the file extension with `.zip`

## `Oledump.py`

We can use `oledump.py` on office documents to identify any hidden macros that will be executed.

Running the initial `oledump.py` on a file separate the office objects.

![image](https://user-images.githubusercontent.com/7328587/121040450-7d160c80-c7e4-11eb-8fc9-016cebfb665c.png)

`oledump.py <file>`

The line marked with the letter `M` indicates that a macro is present. To look at its contents, we pass the section number (7), and tell oledump to do a VB decompression

`oledump.py <file> -s 7 -v`

![image](https://user-images.githubusercontent.com/7328587/121040827-cd8d6a00-c7e4-11eb-9746-15057c30211a.png)
