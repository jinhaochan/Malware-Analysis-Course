# Analyzing PDF files

![image](https://user-images.githubusercontent.com/7328587/121539978-adee7f80-ca38-11eb-8e4f-48315a11c0db.png)

## Sections

1. Header
2. Body
3. Xref
4. Trailer

## PDF objects

```
1 0 obj
  << /Type /Catalog
    /Pages 2 0 R
  >>
endobj
```

name = 1

version = 0

`obj` and `endobj` starts and ends the object

`<< ... >>` defines a dictionary

## PDF Xref table

```
xref
0 271
0000000000 65535 f
0000000015 00000 n
0000000102 00000 n
```

0 = start of object

271 = number of items in the body

offsets from the beginning of the document

n = in use

f = free

## PDF Trailer

```
trailer
  << /Root 1 0 R
     /Size 4
  >>
startxref
249
%%EOF
```

overall infomation of the PDF file

startxref = beginning of the xref table


## PDFID tool

![image](https://user-images.githubusercontent.com/7328587/121541478-ec386e80-ca39-11eb-860a-76cc377475de.png)

This tool helps us breakdown a PDF file, and tell us information about it such as the number of objects and the number of streams.

We can see that there are some suspicious tags

`/JS`, `/JavaScript`, and `/OpenAction`

`/JS` and `/JavaScript` tells us that there is JavaScript code in the PDF file

`/OpenAction` defines actions that will immediately be executed when the PDF file is open

## PDF Parser

`pdf-parser.py <pdf file>`

This command dumps the raw contents of the PDF file

`pdf-parser.py <pdf file> -s <string>`

Searches for strings within the PDF contents. This is helpful because you done have to open the PDF file to search for metadata contents


`pdf-parser.py <pdf file> -o <object ID>`

Shows the contents of specified Object ID. This is for searching for suspicious objects within the PDF file

## PDF StreamDumper

![image](https://user-images.githubusercontent.com/7328587/121544063-02dfc500-ca3c-11eb-8c6f-0d0dc5ff7a35.png)

This tool gives a GUI analysis of the PDF file
